<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Attention Check</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <!-- <h3>Attention Check</h3> -->
                    </div>
                    <div class="card-body">
                        <p>
                            The next question is about the following problem. In questionnaires like ours, sometimes
                            there are participants who do not carefully read the questions and just quickly click
                            through the survey. This means that there are a lot of random answers which compromise the
                            results of research studies. To show that you read our questions carefully, please choose
                            both Others and Agree options as your answer to the next question.
                        </p>

                        <form method="POST" action="{{ url_for('survey_bp.educating') }}" id="attentionCheckForm">
                            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                            <p><strong>Do you agree that yellow is your favorite color?</strong></p>

                            <div id="checkboxContainer">
                                <!-- Checkboxes will be inserted here via JS -->
                            </div>

                            <br>
                            <button type="submit" class="btn btn-primary">Submit</button>
                        </form>

                        <p class="mt-3 text-muted">Please follow the instructions carefully to proceed.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const options = [
            { id: "strongDisagree", label: "Strongly Disagree", value: "Strongly Disagree" },
            { id: "disagree", label: "Disagree", value: "Disagree" },
            { id: "neutral", label: "Neutral", value: "Neutral" },
            { id: "agree", label: "Agree", value: "Agree" },
            { id: "strongAgree", label: "Strongly Agree", value: "Strongly Agree" },
            { id: "others", label: "Others", value: "Others" },
        ];

        // Shuffle array
        /*
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }
        */

        // Inject shuffled checkboxes into the DOM
        window.onload = function () {
            //shuffle(options);
            const container = document.getElementById("checkboxContainer");
            options.forEach(opt => {
                const div = document.createElement("div");
                div.className = "form-check";

                const input = document.createElement("input");
                input.className = "form-check-input";
                input.type = "checkbox";
                input.name = "answer";
                input.id = opt.id;
                input.value = opt.value;

                const label = document.createElement("label");
                label.className = "form-check-label";
                label.htmlFor = opt.id;
                label.textContent = opt.label;

                div.appendChild(input);
                div.appendChild(label);
                container.appendChild(div);
            });
        };

        // Validate on submit
        document.getElementById("attentionCheckForm").addEventListener("submit", function (event) {
            const checkboxes = document.querySelectorAll('input[name="answer"]:checked');
            const selectedValues = Array.from(checkboxes).map(cb => cb.value);

            if (!(selectedValues.includes("Agree") && selectedValues.includes("Others") && selectedValues.length === 2)) {
                event.preventDefault();
                alert("Your answer is not correct, please read the question again.");
            }
        });
    </script>
</body>

</html>